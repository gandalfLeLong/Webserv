server {
    listen 8080;                 # Port the server listens on
    server_name example.com;      # Server domain name or IP address

    # Default error pages
    error_page 404 /404.html;        # Redirect 404 errors to a custom 404 page
    error_page 500 502 503 504 /50x.html;  # Redirect server errors to a custom 50x page

    # Location to handle the 404 error page
    location = /404.html {
        root /var/www/html;       # Directory to serve the 404.html file
    }

    # Location to handle the 50x error pages
    location = /50x.html {
        root /var/www/html;       # Directory to serve the 50x.html file
    }

    # Limit client body size for file uploads
    client_max_body_size 10M;      # Limit upload size to 10MB

    # Static file handling and directory listing
    location /files/ {
        root /var/www/html;       # Serve static files from /var/www/html/files/
        autoindex on;             # Enable directory listing
    }

    # Handle PHP scripts (assuming PHP is running via FastCGI)
    location ~ \.php$ {
        fastcgi_pass 127.0.0.1:9000;  # Pass PHP requests to FastCGI server
        fastcgi_param SCRIPT_FILENAME /var/www/html$fastcgi_script_name;  # Path to the PHP script
        include fastcgi_params;        # Include standard FastCGI params
    }

    # Restrict access to methods for /submit route (allow only GET and POST)
    location /submit {
        limit_except GET POST {  # Allow only GET and POST methods
            deny all;          # Deny other methods like DELETE, PUT, etc.
        }
    }

    # Redirect from old path to a new path
    location /old-path {
        return 301 http://example.com/new-path;  # Permanent redirect to new path
    }

    # Handle file uploads
    location /upload {
        root /var/www/uploads;  # Files will be saved in /var/www/uploads/
        client_max_body_size 50M;  # Increase upload limit for /upload to 50MB
    }

    # Default behavior for root path
    location / {
        root /var/www/html;      # Serve static files from /var/www/html/
        index index.html;        # Default file to serve if a directory is requested
    }

    # Handle specific file extensions for uploads (example: images)
    location ~* \.(jpg|jpeg|png|gif|pdf|docx)$ {
        root /var/www/uploads;  # Serve files from the /uploads directory
        autoindex off;           # Disable directory listing for uploaded files
    }

    # Allow access to all paths under /static/ directory
    location /static/ {
        root /var/www/static;    # Serve static files from /var/www/static/
    }

    # Default location block for handling files (in case the path is not matched)
    location /default {
        root /var/www/html;      # Default root for non-specific locations
        index index.html;        # Default index file
    }
}
